<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–û–±—Ä–∞–±–æ—Ç–∫–∞...</title>
    <link rel="stylesheet" href="/static/css/modern-style.css">
    <script>
        // –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
        const intervalId = setInterval(function() {
            console.log("–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏...");
            fetch("/status/{{ task_id }}")
                .then(resp => resp.json())
                .then(data => {
                    console.log("–°—Ç–∞—Ç—É—Å:", data.status);
                    
                    if (data.status === "completed" || data.status === "error") {
                        clearInterval(intervalId);
                        console.log("–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞");
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                        fetch("/result/{{ task_id }}")
                            .then(resp => resp.text())
                            .then(html => {
                                // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML
                                const tempDiv = document.createElement('div');
                                tempDiv.innerHTML = html;
                                
                                // –ù–∞—Ö–æ–¥–∏–º body –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º HTML
                                const newBody = tempDiv.querySelector('body');
                                if (newBody) {
                                    document.body.innerHTML = newBody.innerHTML;
                                } else {
                                    document.body.innerHTML = html;
                                }
                                
                                // –û–±–Ω–æ–≤–ª—è–µ–º title —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                                const titleElement = tempDiv.querySelector('title');
                                if (titleElement) {
                                    document.title = titleElement.textContent;
                                }
                            })
                            .catch(err => console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:", err));
                    }
                })
                .catch(err => {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞:", err);
                });
        }, 3000);
    </script>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞</h1>
            <p class="subtitle">–ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</p>
            
            <div class="progress-container">
                <div class="spinner"></div>
                <h3>ü§ñ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</h3>
                <p>–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
                <span class="status-badge status-processing">–û–±—Ä–∞–±–æ—Ç–∫–∞</span>
            </div>
            
            <div class="navigation">
                <a href="/upload">üì§ –ù–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞</a>
                
            </div>
        </div>
    </div>
</body>
</html>
