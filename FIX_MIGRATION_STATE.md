# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

## –ü—Ä–æ–±–ª–µ–º–∞: "column already exists"

–ï—Å–ª–∏ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –æ —Ç–æ–º, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∏ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Ä—É—á–Ω—É—é, –∞ Alembic –æ–± —ç—Ç–æ–º –Ω–µ –∑–Ω–∞–µ—Ç.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–º–µ—Ç–∫–∞ –ë–î –∫–∞–∫ –∏–º–µ—é—â–µ–π –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∏ —É–∂–µ –µ—Å—Ç—å)

```bash
venv\Scripts\alembic.exe stamp head
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–º–µ—á–∞–µ—Ç –ë–î –∫–∞–∫ –∏–º–µ—é—â—É—é –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–µ–∑ –∏—Ö —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–º–µ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏

–ï—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∏ –∏–∑ –ø–µ—Ä–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —É–∂–µ –µ—Å—Ç—å, –Ω–æ –≤—Ç–æ—Ä–æ–π –Ω–µ—Ç:

```bash
# –ü–æ–º–µ—Ç–∏—Ç—å –ø–µ—Ä–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
venv\Scripts\alembic.exe stamp 001_archive_status

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Ç–æ—Ä—É—é
venv\Scripts\alembic.exe upgrade head
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—Ç–∫–∞—Ç –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
venv\Scripts\alembic.exe downgrade base

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∑–∞–Ω–æ–≤–æ (–º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫)
venv\Scripts\alembic.exe upgrade head
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é:

```bash
venv\Scripts\alembic.exe current
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
002_password_changed_at (head)
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é:

```bash
venv\Scripts\alembic.exe history
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏ –≤ –ë–î:

```sql
SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'users' 
AND column_name IN ('is_archived', 'archived_at', 'archived_by_admin', 'password_changed_at');
```

## üìù –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

–ú–∏–≥—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º:

1. **001_archive_status** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `is_archived`, `archived_at`, `archived_by_admin`
2. **002_password_changed_at** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `password_changed_at`

–¢–µ–ø–µ—Ä—å –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** `002_password_changed_at (head)`


